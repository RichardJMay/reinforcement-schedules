<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Reinforcement Simulator</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 24px;
            box-shadow: 0 30px 90px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 { 
            font-size: 2.5em; 
            margin-bottom: 10px;
            font-weight: 800;
        }
        
        .header p { 
            opacity: 0.95; 
            font-size: 1.2em;
        }
        
        .warning-banner {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .mode-selector {
            background: linear-gradient(to right, #f8f9fa, #fff);
            padding: 25px;
            text-align: center;
            border-bottom: 3px solid #e9ecef;
        }
        
        .mode-selector label {
            font-weight: 700;
            margin-right: 15px;
            color: #495057;
            font-size: 1.1em;
        }
        
        .mode-selector select {
            padding: 12px 24px;
            font-size: 1.05em;
            border: 3px solid #667eea;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }
        
        .content { padding: 35px; }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .control-group {
            background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);
            padding: 24px;
            border-radius: 16px;
            border: 2px solid #e9ecef;
            transition: all 0.3s;
        }
        
        .control-group:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
        }
        
        .control-group label {
            display: block;
            font-weight: 700;
            color: #495057;
            margin-bottom: 12px;
            font-size: 1em;
        }
        
        .control-group select,
        .control-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s;
        }
        
        .control-group .help-text {
            font-size: 0.85em;
            color: #6c757d;
            margin-top: 8px;
            font-style: italic;
        }
        
        .schedule-explanation {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 3px solid #ffc107;
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 25px;
            font-size: 1.05em;
            line-height: 1.6;
        }
        
        .schedule-explanation strong {
            color: #856404;
        }
        
        .simulation-area {
            background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }
        
        .phone-mockup {
            max-width: 400px;
            margin: 0 auto 30px;
            background: #000;
            border-radius: 40px;
            padding: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .phone-screen {
            background: white;
            border-radius: 30px;
            padding: 20px;
            min-height: 300px;
            position: relative;
            overflow: hidden;
        }
        
        .phone-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 20px;
        }
        
        .app-name {
            font-weight: 800;
            font-size: 1.3em;
            color: #667eea;
        }
        
        .notification-badge {
            background: #dc3545;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            font-weight: 700;
        }
        
        .feed-content {
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .no-notifications {
            color: #6c757d;
            font-style: italic;
            padding: 40px;
        }
        
        .notification-item {
            background: linear-gradient(135deg, #e7f3ff 0%, #d6e9ff 100%);
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 15px;
            margin: 10px 0;
            animation: slideIn 0.3s ease;
            width: 100%;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .notification-icon {
            font-size: 1.5em;
            margin-right: 10px;
        }
        
        .session-controls {
            margin-bottom: 25px;
        }
        
        .btn-session {
            padding: 16px 40px;
            font-size: 1.2em;
            font-weight: 700;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn-start {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4);
        }
        
        .btn-start:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(40, 167, 69, 0.5);
        }
        
        .btn-stop {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
        }
        
        .check-phone-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 24px 60px;
            font-size: 1.5em;
            font-weight: 700;
            border-radius: 60px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .check-phone-btn::before {
            content: 'üì±';
            margin-right: 10px;
            font-size: 1.2em;
        }
        
        .check-phone-btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
        }
        
        .check-phone-btn:active {
            transform: scale(0.98);
        }
        
        .check-phone-btn:disabled {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 18px;
            margin-top: 25px;
        }
        
        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 16px;
            border: 2px solid #e9ecef;
            transition: all 0.3s;
        }
        
        .stat-box:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(102, 126, 234, 0.2);
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #6c757d;
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .feedback {
            margin-top: 25px;
            padding: 20px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 1.1em;
            min-height: 60px;
        }
        
        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            border: 2px solid #e9ecef;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        
        .chart-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #495057;
            margin-bottom: 20px;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 14px 35px;
            border: none;
            border-radius: 50px;
            font-size: 1.05em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }
        
        .btn-pause {
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
            color: #000;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
        }
        
        .info-section {
            background: linear-gradient(135deg, #ffe5e5 0%, #ffd6d6 100%);
            padding: 25px;
            border-radius: 16px;
            border-left: 5px solid #dc3545;
            margin-top: 25px;
        }
        
        .info-section h3 {
            color: #dc3545;
            margin-bottom: 12px;
            font-size: 1.3em;
            font-weight: 700;
        }
        
        .info-section p {
            color: #721c24;
            line-height: 1.8;
            font-size: 1.05em;
        }
        
        .dopamine-hit {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4em;
            animation: dopamineExplode 1s ease-out;
            pointer-events: none;
            z-index: 9999;
        }
        
        @keyframes dopamineExplode {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.5);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(2) translateY(-100px);
            }
        }
        
        .addiction-meter {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .meter-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
        }
        
        .meter-bar {
            background: #dee2e6;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        
        .meter-fill {
            background: linear-gradient(90deg, #28a745 0%, #ffc107 50%, #dc3545 100%);
            height: 100%;
            width: 0%;
            transition: width 0.5s;
            border-radius: 15px;
        }
        
        .compound-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .schedule-panel {
            background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);
            padding: 25px;
            border-radius: 16px;
            border: 3px solid #e9ecef;
        }
        
        .schedule-panel h3 {
            color: #667eea;
            margin-bottom: 18px;
            font-size: 1.2em;
            font-weight: 700;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üì± Social Media Reinforcement Simulator</h1>
            <p>Understanding the Psychology Behind Digital Addiction</p>
        </div>
        
        <div class="warning-banner">
            ‚ö†Ô∏è This simulator demonstrates how social media platforms use reinforcement schedules to create addictive behavior patterns
        </div>
        
        <div class="mode-selector">
            <label for="schedule-mode">Scenario:</label>
            <select id="schedule-mode">
                <option value="simple">Single Platform Behaviors</option>
                <option value="compound">Multi-Platform & Complex Behaviors</option>
            </select>
        </div>
        
        <div class="content">
            <!-- Simple Mode -->
            <div id="simple-mode">
                <div class="controls">
                    <div class="control-group">
                        <label for="schedule-type">Reinforcement Algorithm</label>
                        <select id="schedule-type">
                            <option value="FR">Fixed Ratio - Instagram Likes</option>
                            <option value="VR">Variable Ratio - Twitter Engagement</option>
                            <option value="RR">Random Ratio - TikTok Virality</option>
                            <option value="FI">Fixed Interval - LinkedIn Weekly Digest</option>
                            <option value="VI">Variable Interval - Facebook Notifications</option>
                            <option value="FT">Fixed Time - Snapchat Streaks</option>
                            <option value="VT">Variable Time - YouTube Recommendations</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label for="schedule-value">Algorithm Intensity</label>
                        <input type="number" id="schedule-value" value="5" min="1" max="100">
                        <div class="help-text">Lower = more frequent rewards</div>
                    </div>
                    <div class="control-group">
                        <label for="variability">Unpredictability</label>
                        <input type="number" id="variability" value="3" min="0" max="50">
                        <div class="help-text">How random the rewards are</div>
                    </div>
                    <div class="control-group" id="rr-prob-group" style="display:none;">
                        <label for="rr-probability">Viral Probability</label>
                        <input type="number" id="rr-probability" value="0.2" min="0.01" max="1" step="0.01">
                        <div class="help-text">Chance of going viral per post</div>
                    </div>
                </div>
                
                <div class="schedule-explanation" id="schedule-explanation">
                    <strong>üìä Current Algorithm:</strong> <span id="explanation-text">Select a schedule to see how it manipulates behavior</span>
                </div>
                
                <div class="addiction-meter">
                    <div class="meter-label">üß† Behavioral Persistence Score 
                        <span style="font-size: 0.85em; font-weight: 400; color: #6c757d;">
                            (Response rate + Extinction resistance + Pattern consistency)
                        </span>
                    </div>
                    <div class="meter-bar">
                        <div class="meter-fill" id="addiction-meter"></div>
                    </div>
                    <div style="font-size: 0.85em; color: #6c757d; margin-top: 8px; font-style: italic;">
                        <span style="color: #28a745;">‚óè Low (0-33)</span> | 
                        <span style="color: #ffc107;">‚óè Moderate (34-66)</span> | 
                        <span style="color: #dc3545;">‚óè High (67-100)</span>
                    </div>
                </div>
                
                <div class="simulation-area">
                    <div class="session-controls">
                        <button class="btn-session btn-start" id="start-btn">‚ñ∂ Start Using App</button>
                    </div>
                    
                    <div class="phone-mockup">
                        <div class="phone-screen">
                            <div class="phone-header">
                                <div class="app-name" id="app-name">SocialApp</div>
                                <div class="notification-badge" id="notif-badge" style="display:none;">0</div>
                            </div>
                            <div class="feed-content" id="feed-content">
                                <div class="no-notifications">Pull to refresh...</div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="check-phone-btn" id="check-phone-btn" disabled>Check Phone</button>
                    
                    <div class="stats">
                        <div class="stat-box">
                            <div class="stat-label">üì± Checks</div>
                            <div class="stat-value" id="total-responses">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">üíñ Rewards</div>
                            <div class="stat-value" id="total-reinforcements">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">‚ö° Check Rate</div>
                            <div class="stat-value" id="response-rate">0.0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">‚è±Ô∏è Time</div>
                            <div class="stat-value" id="time-elapsed">0s</div>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-pause" id="pause-btn" disabled>Pause</button>
                        <button class="btn btn-reset" id="reset-btn">Reset</button>
                    </div>
                </div>
            </div>
            
            <!-- Compound Mode -->
            <div id="compound-mode" style="display:none;">
                <div class="controls">
                    <div class="control-group">
                        <label for="compound-type">Complex Behavior Pattern</label>
                        <select id="compound-type">
                            <option value="concurrent">App Switching (Concurrent)</option>
                            <option value="multiple">Algorithm Changes (Multiple)</option>
                            <option value="chained">Engagement Funnel (Chained)</option>
                            <option value="conjunctive">Both Time & Engagement (Conjunctive)</option>
                            <option value="alternative">Quick Hits vs Deep Dive (Alternative)</option>
                            <option value="lag">Content Variety Reward (Lag)</option>
                        </select>
                    </div>
                </div>
                
                <div class="schedule-explanation" id="compound-explanation">
                    <strong>üìä Current Pattern:</strong> <span id="compound-explanation-text">Select a pattern to see how platforms combine reinforcement</span>
                </div>
                
                <!-- Config panels -->
                <div id="config-concurrent" class="compound-controls">
                    <div class="schedule-panel">
                        <h3>üìò Platform A (e.g., Instagram)</h3>
                        <div class="control-group">
                            <label>Algorithm</label>
                            <select id="left-schedule">
                                <option value="FR">Fixed Ratio</option>
                                <option value="VR">Variable Ratio</option>
                                <option value="FI">Fixed Interval</option>
                                <option value="VI">Variable Interval</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Intensity</label>
                            <input type="number" id="left-value" value="5" min="1">
                        </div>
                    </div>
                    <div class="schedule-panel">
                        <h3>üê¶ Platform B (e.g., Twitter)</h3>
                        <div class="control-group">
                            <label>Algorithm</label>
                            <select id="right-schedule">
                                <option value="FR">Fixed Ratio</option>
                                <option value="VR">Variable Ratio</option>
                                <option value="FI">Fixed Interval</option>
                                <option value="VI">Variable Interval</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Intensity</label>
                            <input type="number" id="right-value" value="10" min="1">
                        </div>
                    </div>
                </div>
                
                <div id="config-multiple" class="compound-controls" style="display:none;">
                    <div class="schedule-panel">
                        <h3>üü¢ High Engagement Algorithm</h3>
                        <div class="control-group">
                            <label>Type</label>
                            <select id="mult-schedule-a">
                                <option value="FR">FR</option>
                                <option value="VR">VR</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Value</label>
                            <input type="number" id="mult-value-a" value="3" min="1">
                        </div>
                    </div>
                    <div class="schedule-panel">
                        <h3>üü£ Low Engagement Algorithm</h3>
                        <div class="control-group">
                            <label>Type</label>
                            <select id="mult-schedule-b">
                                <option value="FR">FR</option>
                                <option value="VR">VR</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>Value</label>
                            <input type="number" id="mult-value-b" value="15" min="1">
                        </div>
                    </div>
                </div>
                
                <div id="config-chained" class="controls" style="display:none;">
                    <div class="control-group">
                        <label>Funnel Steps</label>
                        <input type="number" id="chain-links" value="3" min="2" max="5">
                        <div class="help-text">View ‚Üí Like ‚Üí Comment ‚Üí Share</div>
                    </div>
                    <div class="control-group">
                        <label>Actions per Step</label>
                        <input type="number" id="chain-responses" value="5" min="1">
                    </div>
                </div>
                
                <div id="config-conjunctive" class="controls" style="display:none;">
                    <div class="control-group">
                        <label>Required Interactions</label>
                        <input type="number" id="conj-responses" value="10" min="1">
                    </div>
                    <div class="control-group">
                        <label>Required Time (sec)</label>
                        <input type="number" id="conj-time" value="30" min="1">
                    </div>
                </div>
                
                <div id="config-alternative" class="controls" style="display:none;">
                    <div class="control-group">
                        <label>Quick Checks</label>
                        <input type="number" id="alt-responses" value="10" min="1">
                        <div class="help-text">Many fast checks</div>
                    </div>
                    <div class="control-group">
                        <label>OR Deep Scroll (sec)</label>
                        <input type="number" id="alt-time" value="30" min="1">
                        <div class="help-text">One long session</div>
                    </div>
                </div>
                
                <div id="config-lag" class="controls" style="display:none;">
                    <div class="control-group">
                        <label>Content Variety Requirement</label>
                        <input type="number" id="lag-n" value="3" min="1" max="10">
                        <div class="help-text">Must try different content types</div>
                    </div>
                    <div class="control-group">
                        <label>Content Types Available</label>
                        <input type="number" id="lag-options" value="4" min="2" max="8">
                        <div class="help-text">Photos, Videos, Stories, etc.</div>
                    </div>
                </div>
                
                <div class="simulation-area">
                    <div class="session-controls">
                        <button class="btn-session btn-start" id="compound-start-btn">‚ñ∂ Start Session</button>
                    </div>
                    
                    <div class="phone-mockup">
                        <div class="phone-screen">
                            <div class="phone-header">
                                <div class="app-name">Multi-Platform</div>
                                <div class="notification-badge" id="compound-notif-badge" style="display:none;">0</div>
                            </div>
                            <div class="feed-content" id="compound-feed-content">
                                <div class="no-notifications">Start session to begin...</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin: 20px 0;" id="compound-buttons-container">
                        <button class="check-phone-btn" id="left-btn" disabled style="margin: 10px;">Check Instagram</button>
                        <button class="check-phone-btn" id="right-btn" disabled style="margin: 10px;">Check Twitter</button>
                    </div>
                    
                    <div class="stats">
                        <div class="stat-box">
                            <div class="stat-label">üìò Platform A</div>
                            <div class="stat-value" id="left-responses">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">üê¶ Platform B</div>
                            <div class="stat-value" id="right-responses">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">üíñ Rewards</div>
                            <div class="stat-value" id="compound-reinforcements">0</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">‚è±Ô∏è Time</div>
                            <div class="stat-value" id="compound-time">0s</div>
                        </div>
                    </div>
                    
                    <div class="button-group">
                        <button class="btn btn-pause" id="compound-pause" disabled>Pause</button>
                        <button class="btn btn-reset" id="compound-reset">Reset</button>
                    </div>
                </div>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">üìà Behavior Pattern Over Time</div>
                <canvas id="cumulative-chart" width="800" height="400"></canvas>
            </div>
            
            <div class="info-section">
                <h3>‚ö†Ô∏è The Dark Pattern</h3>
                <p><strong>Social media platforms deliberately use these reinforcement schedules to keep you addicted.</strong> Variable ratio schedules (like slot machines) are especially effective at creating compulsive checking behavior. Notice how unpredictable rewards make you check more frequently than predictable ones? That's by design. These platforms profit from your attention and engineer their algorithms to maximize engagement, not your wellbeing.</p>
            </div>
        </div>
    </div>
    
    <script>
        const scheduleExplanations = {
            'FR': 'üéØ <strong>Instagram Likes Pattern:</strong> Get exactly X likes every Y posts. Predictable but still rewarding. Creates steady, moderate engagement.',
            'VR': 'üé≤ <strong>Twitter Engagement:</strong> Likes and retweets vary around an average. Most addictive schedule - like a slot machine. You never know when the next reward comes!',
            'RR': 'üî• <strong>TikTok Virality:</strong> Each post has a random chance of going viral. Pure gambling mechanics. Extremely addictive.',
            'FI': 'üìß <strong>LinkedIn Weekly Digest:</strong> Notifications arrive at fixed times. Creates "checking" behavior before expected reward time.',
            'VI': 'üîî <strong>Facebook Notifications:</strong> Unpredictable timing of notifications. Encourages frequent checking - you never know when something interesting arrives.',
            'FT': 'üî• <strong>Snapchat Streaks:</strong> Rewards delivered on fixed schedule regardless of behavior. Creates obligation and FOMO.',
            'VT': 'üì∫ <strong>YouTube Recommendations:</strong> New videos appear unpredictably. Keeps you refreshing to see what\'s new.'
        };
        
        const compoundExplanations = {
            'concurrent': 'üì± <strong>App Switching:</strong> Two platforms competing for your attention, each with its own reward schedule. Notice how you develop preferences based on which is more rewarding?',
            'multiple': 'üîÑ <strong>Algorithm A/B Testing:</strong> Platform randomly switches between generous and stingy algorithms. Keeps you guessing and checking.',
            'chained': '‚õìÔ∏è <strong>Engagement Funnel:</strong> Must complete steps (view ‚Üí like ‚Üí comment) to get bigger rewards. Platforms use this to increase your investment.',
            'conjunctive': '‚è∞ <strong>Daily Quest Pattern:</strong> Must spend time AND interact enough. Games and streaks use this to create daily habits.',
            'alternative': 'üèÉ <strong>Engagement Flexibility:</strong> Rewards quick checks OR deep scrolling. Accommodates different usage patterns to keep everyone hooked.',
            'lag': 'üé® <strong>Content Variety Bonus:</strong> Rewards trying different content types. Keeps you exploring and prevents boredom.'
        };
        
        const rewardMessages = [
            '‚ù§Ô∏è Sarah liked your photo!',
            'üí¨ 3 new comments on your post',
            'üîÑ Your tweet got retweeted 12 times!',
            'üëç Jake and 24 others liked your status',
            'üì∏ You\'re tagged in 2 photos',
            '‚≠ê Your post is trending!',
            'üéâ 100 new followers!',
            'üíØ Someone shared your content',
            'üî• Your story has 50 views',
            '‚ú® Featured in recommended!'
        ];
        
        let audioContext;
        try {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        } catch(e) {}
        
        function playNotificationSound() {
            if (!audioContext) return;
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.2);
        }
        
        function showDopamineHit() {
            const emojis = ['üíñ', '‚≠ê', 'üéâ', '‚ú®', 'üî•', 'üíØ'];
            const hit = document.createElement('div');
            hit.className = 'dopamine-hit';
            hit.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            document.body.appendChild(hit);
            setTimeout(() => hit.remove(), 1000);
        }
        
        class Simulator {
            constructor() {
                this.mode = 'simple';
                this.sessionActive = false;
                this.init();
                this.reset();
                this.attachListeners();
                setInterval(() => this.update(), 100);
                this.updateExplanation();
            }
            
            init() {
                this.modeSelector = document.getElementById('schedule-mode');
                this.simpleMode = document.getElementById('simple-mode');
                this.compoundMode = document.getElementById('compound-mode');
                this.scheduleType = document.getElementById('schedule-type');
                this.scheduleValue = document.getElementById('schedule-value');
                this.variability = document.getElementById('variability');
                this.rrProbability = document.getElementById('rr-probability');
                this.rrProbGroup = document.getElementById('rr-prob-group');
                
                this.explanationText = document.getElementById('explanation-text');
                this.compoundExplanationText = document.getElementById('compound-explanation-text');
                
                this.startBtn = document.getElementById('start-btn');
                this.compoundStartBtn = document.getElementById('compound-start-btn');
                this.checkPhoneBtn = document.getElementById('check-phone-btn');
                this.pauseBtn = document.getElementById('pause-btn');
                this.resetBtn = document.getElementById('reset-btn');
                
                this.feedContent = document.getElementById('feed-content');
                this.notifBadge = document.getElementById('notif-badge');
                this.appName = document.getElementById('app-name');
                this.addictionMeter = document.getElementById('addiction-meter');
                
                this.totalResponsesEl = document.getElementById('total-responses');
                this.totalReinforcementsEl = document.getElementById('total-reinforcements');
                this.responseRateEl = document.getElementById('response-rate');
                this.timeElapsedEl = document.getElementById('time-elapsed');
                
                this.compoundType = document.getElementById('compound-type');
                this.leftBtn = document.getElementById('left-btn');
                this.rightBtn = document.getElementById('right-btn');
                this.compoundFeedContent = document.getElementById('compound-feed-content');
                this.compoundNotifBadge = document.getElementById('compound-notif-badge');
                this.compoundPauseBtn = document.getElementById('compound-pause');
                this.compoundResetBtn = document.getElementById('compound-reset');
                
                this.leftResponsesEl = document.getElementById('left-responses');
                this.rightResponsesEl = document.getElementById('right-responses');
                this.compoundReinforcementsEl = document.getElementById('compound-reinforcements');
                this.compoundTimeEl = document.getElementById('compound-time');
                
                this.canvas = document.getElementById('cumulative-chart');
                this.ctx = this.canvas.getContext('2d');
            }
            
            attachListeners() {
                this.modeSelector.addEventListener('change', () => this.switchMode());
                this.startBtn.addEventListener('click', () => this.startSession());
                this.compoundStartBtn.addEventListener('click', () => this.startSession());
                this.checkPhoneBtn.addEventListener('click', () => this.handleResponse());
                this.resetBtn.addEventListener('click', () => this.reset());
                this.pauseBtn.addEventListener('click', () => this.togglePause());
                this.scheduleType.addEventListener('change', () => {
                    this.updateRRVisibility();
                    this.updateExplanation();
                    this.updateAppName();
                });
                this.compoundType.addEventListener('change', () => {
                    this.updateCompoundConfig();
                    this.updateCompoundExplanation();
                });
                this.leftBtn.addEventListener('click', () => this.handleCompoundResponse('left'));
                this.rightBtn.addEventListener('click', () => this.handleCompoundResponse('right'));
                this.compoundPauseBtn.addEventListener('click', () => this.togglePause());
                this.compoundResetBtn.addEventListener('click', () => this.reset());
                
                const lagOptions = document.getElementById('lag-options');
                if (lagOptions) {
                    lagOptions.addEventListener('change', () => {
                        if (this.compoundType.value === 'lag') {
                            this.createLagButtons();
                        }
                    });
                }
            }
            
            updateExplanation() {
                const schedule = this.scheduleType.value;
                this.explanationText.innerHTML = scheduleExplanations[schedule] || '';
            }
            
            updateCompoundExplanation() {
                const type = this.compoundType.value;
                this.compoundExplanationText.innerHTML = compoundExplanations[type] || '';
            }
            
            updateAppName() {
                const names = {
                    'FR': 'Instagram',
                    'VR': 'Twitter',
                    'RR': 'TikTok',
                    'FI': 'LinkedIn',
                    'VI': 'Facebook',
                    'FT': 'Snapchat',
                    'VT': 'YouTube'
                };
                this.appName.textContent = names[this.scheduleType.value] || 'SocialApp';
            }
            
            startSession() {
                this.sessionActive = true;
                this.sessionStartTime = Date.now();
                this.startTime = Date.now();
                
                this.startBtn.textContent = '‚èπ Stop Session';
                this.startBtn.className = 'btn-session btn-stop';
                this.startBtn.onclick = () => this.stopSession();
                
                this.compoundStartBtn.textContent = '‚èπ Stop Session';
                this.compoundStartBtn.className = 'btn-session btn-stop';
                this.compoundStartBtn.onclick = () => this.stopSession();
                
                this.checkPhoneBtn.disabled = false;
                this.pauseBtn.disabled = false;
                this.leftBtn.disabled = false;
                this.rightBtn.disabled = false;
                this.compoundPauseBtn.disabled = false;
                
                // Initialize multiple schedule buttons if in multiple mode
                if (this.mode === 'compound' && this.compoundType.value === 'multiple') {
                    this.currentMultSchedule = 'A';
                    this.updateMultipleScheduleButtons();
                }
                
                this.feedContent.innerHTML = '<div class="no-notifications">No new notifications...</div>';
                this.compoundFeedContent.innerHTML = '<div class="no-notifications">Check your apps...</div>';
            }
            
            stopSession() {
                this.sessionActive = false;
                
                this.startBtn.textContent = '‚ñ∂ Start Using App';
                this.startBtn.className = 'btn-session btn-start';
                this.startBtn.onclick = () => this.startSession();
                
                this.compoundStartBtn.textContent = '‚ñ∂ Start Session';
                this.compoundStartBtn.className = 'btn-session btn-start';
                this.compoundStartBtn.onclick = () => this.startSession();
                
                this.checkPhoneBtn.disabled = true;
                this.pauseBtn.disabled = true;
                this.leftBtn.disabled = true;
                this.rightBtn.disabled = true;
                this.compoundPauseBtn.disabled = true;
                
                // Reset button styling
                this.leftBtn.style.opacity = '1';
                this.leftBtn.style.transform = 'scale(1)';
                this.rightBtn.style.opacity = '1';
                this.rightBtn.style.transform = 'scale(1)';
            }
            
            switchMode() {
                this.mode = this.modeSelector.value;
                this.simpleMode.style.display = this.mode === 'simple' ? 'block' : 'none';
                this.compoundMode.style.display = this.mode === 'compound' ? 'block' : 'none';
                if (this.mode === 'compound') {
                    this.updateCompoundConfig();
                    this.updateCompoundExplanation();
                }
                this.reset();
            }
            
            updateRRVisibility() {
                this.rrProbGroup.style.display = this.scheduleType.value === 'RR' ? 'block' : 'none';
            }
            
            updateCompoundConfig() {
                const type = this.compoundType.value;
                ['concurrent', 'multiple', 'chained', 'conjunctive', 'alternative', 'lag'].forEach(t => {
                    const el = document.getElementById(`config-${t}`);
                    if (el) el.style.display = t === type ? 'grid' : 'none';
                });
                
                if (type === 'lag') {
                    this.createLagButtons();
                }
            }
            
            createLagButtons() {
                const container = document.getElementById('compound-buttons-container');
                const numOptions = parseInt(document.getElementById('lag-options').value) || 4;
                const labels = ['üì∏ Photos', 'üé• Videos', 'üìñ Stories', 'üí¨ Messages', 'üéµ Reels', 'üì∞ News', 'üéÆ Games', 'üõçÔ∏è Shop'];
                container.innerHTML = '';
                for (let i = 0; i < numOptions; i++) {
                    const btn = document.createElement('button');
                    btn.className = 'check-phone-btn';
                    btn.style.margin = '10px';
                    btn.style.fontSize = '1.2em';
                    btn.style.padding = '15px 30px';
                    btn.textContent = labels[i] || `Option ${i+1}`;
                    btn.disabled = !this.sessionActive;
                    btn.addEventListener('click', () => this.handleCompoundResponse(`opt${i}`));
                    container.appendChild(btn);
                }
            }
            
            reset() {
                this.stopSession();
                this.responses = 0;
                this.reinforcements = 0;
                this.leftResponses = 0;
                this.rightResponses = 0;
                this.startTime = Date.now();
                this.lastReinfTime = Date.now();
                this.isPaused = false;
                this.cumulativeData = [{x:0, y:0, leftY:0, rightY:0, reinf:false, button:null}];
                this.responsesSinceReinf = 0;
                this.nextTarget = 0;
                this.responseHistory = [];
                this.currentMultSchedule = 'A';
                
                this.totalResponsesEl.textContent = '0';
                this.totalReinforcementsEl.textContent = '0';
                this.responseRateEl.textContent = '0.0';
                this.timeElapsedEl.textContent = '0s';
                this.leftResponsesEl.textContent = '0';
                this.rightResponsesEl.textContent = '0';
                this.compoundReinforcementsEl.textContent = '0';
                this.compoundTimeEl.textContent = '0s';
                this.pauseBtn.textContent = 'Pause';
                this.compoundPauseBtn.textContent = 'Pause';
                this.addictionMeter.style.width = '0%';
                this.notifBadge.style.display = 'none';
                this.compoundNotifBadge.style.display = 'none';
                
                this.feedContent.innerHTML = '<div class="no-notifications">Pull to refresh...</div>';
                this.compoundFeedContent.innerHTML = '<div class="no-notifications">Start session to begin...</div>';
                
                this.updateScheduleTarget();
                this.drawChart();
            }
            
            updateScheduleTarget() {
                const schedule = this.scheduleType.value;
                const value = parseInt(this.scheduleValue.value) || 5;
                const vary = parseInt(this.variability.value) || 0;
                
                if (schedule === 'FR') {
                    this.nextTarget = value;
                } else if (schedule === 'VR' || schedule === 'VI' || schedule === 'VT') {
                    this.nextTarget = Math.max(1, value + Math.floor(Math.random() * vary * 2) - vary);
                } else if (schedule === 'FI' || schedule === 'FT') {
                    this.nextTarget = value;
                }
            }
            
            update() {
                if (!this.sessionActive || this.isPaused) return;
                
                const elapsed = Math.floor((Date.now() - this.startTime) / 1000);
                this.timeElapsedEl.textContent = elapsed + 's';
                this.compoundTimeEl.textContent = elapsed + 's';
                
                // Calculate Behavioral Persistence Score
                const meterPercent = this.calculateAddictionScore();
                this.addictionMeter.style.width = meterPercent + '%';
                
                if (this.mode === 'simple') {
                    const schedule = this.scheduleType.value;
                    if (schedule === 'FT' || schedule === 'VT') {
                        const timeSince = Date.now() - this.lastReinfTime;
                        const targetMs = this.nextTarget * 1000;
                        if (timeSince >= targetMs) {
                            this.showReward();
                            this.reinforcements++;
                            this.totalReinforcementsEl.textContent = this.reinforcements;
                            this.lastReinfTime = Date.now();
                            this.updateScheduleTarget();
                            const t = (Date.now() - this.startTime) / 1000;
                            this.cumulativeData.push({x:t, y:this.responses, leftY:0, rightY:0, reinf:true, button:null});
                            this.drawChart();
                        }
                    }
                    
                    const timeElapsed = (Date.now() - this.startTime) / 1000;
                    const rate = timeElapsed > 0 ? (this.responses / timeElapsed).toFixed(2) : 0;
                    this.responseRateEl.textContent = rate;
                }
            }
            
            handleResponse() {
                if (!this.sessionActive || this.isPaused) return;
                
                this.responses++;
                this.responsesSinceReinf++;
                this.totalResponsesEl.textContent = this.responses;
                
                const reinforced = this.checkReinforcement();
                const t = (Date.now() - this.startTime) / 1000;
                this.cumulativeData.push({x:t, y:this.responses, leftY:0, rightY:0, reinf:reinforced, button:null});
                
                if (reinforced) {
                    this.showReward();
                } else {
                    this.feedContent.innerHTML = '<div class="no-notifications">Nothing new right now...</div>';
                    this.notifBadge.style.display = 'none';
                }
                
                this.drawChart();
            }
            
            checkReinforcement() {
                const schedule = this.scheduleType.value;
                const timeSince = Date.now() - this.lastReinfTime;
                const targetMs = this.nextTarget * 1000;
                
                let reinforced = false;
                
                if (schedule === 'FR' && this.responsesSinceReinf >= this.nextTarget) {
                    reinforced = true;
                } else if (schedule === 'VR' && this.responsesSinceReinf >= this.nextTarget) {
                    reinforced = true;
                } else if (schedule === 'RR') {
                    const prob = parseFloat(this.rrProbability.value);
                    if (Math.random() < prob) reinforced = true;
                } else if (schedule === 'FI' && timeSince >= targetMs) {
                    reinforced = true;
                } else if (schedule === 'VI' && timeSince >= targetMs) {
                    reinforced = true;
                }
                
                if (reinforced) {
                    this.reinforcements++;
                    this.totalReinforcementsEl.textContent = this.reinforcements;
                    this.responsesSinceReinf = 0;
                    this.lastReinfTime = Date.now();
                    this.updateScheduleTarget();
                }
                
                return reinforced;
            }
            
            showReward() {
                playNotificationSound();
                showDopamineHit();
                
                const msg = rewardMessages[Math.floor(Math.random() * rewardMessages.length)];
                const notif = document.createElement('div');
                notif.className = 'notification-item';
                notif.textContent = msg;
                
                this.feedContent.innerHTML = '';
                this.feedContent.appendChild(notif);
                
                this.notifBadge.textContent = this.reinforcements;
                this.notifBadge.style.display = 'flex';
            }
            
            handleCompoundResponse(button) {
                if (!this.sessionActive || this.isPaused) return;
                
                // For multiple schedules, only allow response if correct stimulus is active
                if (this.compoundType.value === 'multiple') {
                    const activeButton = this.currentMultSchedule === 'A' ? 'left' : 'right';
                    if (button !== activeButton) return; // Wrong button for current schedule
                }
                
                if (button === 'left') {
                    this.leftResponses++;
                    this.leftResponsesEl.textContent = this.leftResponses;
                } else if (button === 'right') {
                    this.rightResponses++;
                    this.rightResponsesEl.textContent = this.rightResponses;
                }
                
                this.responses = this.leftResponses + this.rightResponses;
                this.responsesSinceReinf++;
                
                let reinforced = false;
                const type = this.compoundType.value;
                
                if (type === 'concurrent') {
                    reinforced = this.checkConcurrent(button);
                } else if (type === 'multiple') {
                    reinforced = this.checkMultiple();
                } else if (type === 'lag') {
                    reinforced = this.checkLag(button);
                }
                
                const t = (Date.now() - this.startTime) / 1000;
                this.cumulativeData.push({
                    x:t, 
                    y:this.responses, 
                    leftY: this.leftResponses,
                    rightY: this.rightResponses,
                    reinf:reinforced,
                    button:button
                });
                this.drawChart();
                
                if (reinforced) {
                    playNotificationSound();
                    showDopamineHit();
                    const msg = rewardMessages[Math.floor(Math.random() * rewardMessages.length)];
                    this.compoundFeedContent.innerHTML = `<div class="notification-item">${msg}</div>`;
                    this.compoundNotifBadge.textContent = this.reinforcements;
                    this.compoundNotifBadge.style.display = 'flex';
                } else {
                    this.compoundFeedContent.innerHTML = '<div class="no-notifications">Nothing new...</div>';
                }
            }
            
            checkConcurrent(button) {
                const leftSched = document.getElementById('left-schedule').value;
                const leftVal = parseInt(document.getElementById('left-value').value);
                const rightSched = document.getElementById('right-schedule').value;
                const rightVal = parseInt(document.getElementById('right-value').value);
                
                if (button === 'left' && leftSched === 'FR' && this.leftResponses % leftVal === 0) {
                    this.reinforcements++;
                    this.compoundReinforcementsEl.textContent = this.reinforcements;
                    return true;
                }
                if (button === 'right' && rightSched === 'FR' && this.rightResponses % rightVal === 0) {
                    this.reinforcements++;
                    this.compoundReinforcementsEl.textContent = this.reinforcements;
                    return true;
                }
                return false;
            }
            
            checkMultiple() {
                const isA = this.currentMultSchedule === 'A';
                const sched = document.getElementById(isA ? 'mult-schedule-a' : 'mult-schedule-b').value;
                const val = parseInt(document.getElementById(isA ? 'mult-value-a' : 'mult-value-b').value);
                
                if (sched === 'FR' && this.responsesSinceReinf >= val) {
                    this.reinforcements++;
                    this.compoundReinforcementsEl.textContent = this.reinforcements;
                    this.responsesSinceReinf = 0;
                    
                    // Switch to next component randomly after reinforcement
                    this.currentMultSchedule = Math.random() < 0.5 ? 'A' : 'B';
                    
                    // Update which button is available
                    this.updateMultipleScheduleButtons();
                    
                    return true;
                }
                return false;
            }
            
            updateMultipleScheduleButtons() {
                if (this.compoundType.value !== 'multiple') return;
                
                const isA = this.currentMultSchedule === 'A';
                
                // Enable/disable buttons based on active schedule
                this.leftBtn.disabled = !isA || !this.sessionActive;
                this.rightBtn.disabled = isA || !this.sessionActive;
                
                // Visual styling to show which is available
                if (isA) {
                    this.leftBtn.style.opacity = '1';
                    this.leftBtn.style.transform = 'scale(1)';
                    this.rightBtn.style.opacity = '0.3';
                    this.rightBtn.style.transform = 'scale(0.9)';
                } else {
                    this.leftBtn.style.opacity = '0.3';
                    this.leftBtn.style.transform = 'scale(0.9)';
                    this.rightBtn.style.opacity = '1';
                    this.rightBtn.style.transform = 'scale(1)';
                }
            }
            
            checkLag(button) {
                const lagN = parseInt(document.getElementById('lag-n').value);
                this.responseHistory.push(button);
                
                if (this.responseHistory.length <= lagN) {
                    this.reinforcements++;
                    this.compoundReinforcementsEl.textContent = this.reinforcements;
                    return true;
                }
                
                const recent = this.responseHistory.slice(-lagN-1, -1);
                if (!recent.includes(button)) {
                    this.reinforcements++;
                    this.compoundReinforcementsEl.textContent = this.reinforcements;
                    return true;
                }
                return false;
            }
            
            togglePause() {
                this.isPaused = !this.isPaused;
                const txt = this.isPaused ? 'Resume' : 'Pause';
                this.pauseBtn.textContent = txt;
                this.compoundPauseBtn.textContent = txt;
            }
            
            calculateAddictionScore() {
                // Behavioral Persistence Score: combines multiple addiction indicators
                const timeElapsed = (Date.now() - this.startTime) / 1000;
                if (timeElapsed < 5) return 0; // Need some time to establish pattern
                
                // Factor 1: Response Rate (0-30 points)
                // Checks per minute - higher rate = more compulsive
                const responseRate = (this.responses / timeElapsed) * 60;
                const rateScore = Math.min(30, responseRate * 2);
                
                // Factor 2: Extinction Resistance (0-30 points)
                // How many checks since last reward - higher = more persistent despite no reward
                const checksSinceReward = this.responsesSinceReinf;
                const extinctionScore = Math.min(30, checksSinceReward * 3);
                
                // Factor 3: Reinforcement Efficiency (0-20 points)
                // Lower ratio but still checking = stronger addiction (VR effect)
                const reinfRatio = this.responses > 0 ? this.reinforcements / this.responses : 0;
                const efficiencyScore = reinfRatio < 0.3 && this.responses > 5 ? 20 : reinfRatio * 40;
                
                // Factor 4: Checking Consistency (0-20 points)
                // Regular checking pattern = habitual behavior
                if (this.responses < 3) {
                    var consistencyScore = 0;
                } else {
                    // Calculate variance in inter-response times
                    const intervals = [];
                    for (let i = 1; i < this.cumulativeData.length; i++) {
                        intervals.push(this.cumulativeData[i].x - this.cumulativeData[i-1].x);
                    }
                    const avgInterval = intervals.reduce((a,b) => a+b, 0) / intervals.length;
                    const variance = intervals.reduce((sum, val) => sum + Math.pow(val - avgInterval, 2), 0) / intervals.length;
                    const consistency = 1 / (1 + variance); // Lower variance = higher consistency
                    var consistencyScore = Math.min(20, consistency * 40);
                }
                
                // Total score (0-100)
                const totalScore = rateScore + extinctionScore + efficiencyScore + consistencyScore;
                
                return Math.min(100, totalScore);
            }
            
            drawChart() {
                this.ctx.fillStyle = '#f8f9fa';
                this.ctx.fillRect(0, 0, 800, 400);
                this.ctx.strokeStyle = '#495057';
                this.ctx.lineWidth = 2;
                this.ctx.beginPath();
                this.ctx.moveTo(50, 350);
                this.ctx.lineTo(750, 350);
                this.ctx.moveTo(50, 350);
                this.ctx.lineTo(50, 50);
                this.ctx.stroke();
                
                this.ctx.fillStyle = '#495057';
                this.ctx.font = '12px Arial';
                this.ctx.fillText('Time', 380, 385);
                this.ctx.save();
                this.ctx.translate(15, 200);
                this.ctx.rotate(-Math.PI / 2);
                this.ctx.fillText('Phone Checks', 0, 0);
                this.ctx.restore();
                
                if (this.cumulativeData.length < 2) return;
                
                const maxT = Math.max(...this.cumulativeData.map(d => d.x));
                const scaleX = 700 / Math.max(maxT, 10);
                
                if (this.mode === 'compound') {
                    const maxLeft = Math.max(...this.cumulativeData.map(d => d.leftY || 0));
                    const maxRight = Math.max(...this.cumulativeData.map(d => d.rightY || 0));
                    const maxY = Math.max(maxLeft, maxRight, 10);
                    const scaleY = 300 / maxY;
                    
                    this.ctx.fillStyle = '#667eea';
                    this.ctx.fillRect(650, 70, 25, 4);
                    this.ctx.fillStyle = '#495057';
                    this.ctx.font = 'bold 12px Arial';
                    this.ctx.fillText('Platform A', 680, 75);
                    
                    this.ctx.fillStyle = '#764ba2';
                    this.ctx.fillRect(650, 90, 25, 4);
                    this.ctx.fillText('Platform B', 680, 95);
                    
                    this.ctx.strokeStyle = '#667eea';
                    this.ctx.lineWidth = 3;
                    this.ctx.beginPath();
                    
                    for (let i = 0; i < this.cumulativeData.length; i++) {
                        const x = 50 + this.cumulativeData[i].x * scaleX;
                        const y = 350 - (this.cumulativeData[i].leftY || 0) * scaleY;
                        
                        if (i === 0) {
                            this.ctx.moveTo(x, y);
                        } else {
                            const prevY = 350 - (this.cumulativeData[i-1].leftY || 0) * scaleY;
                            this.ctx.lineTo(x, prevY);
                            this.ctx.lineTo(x, y);
                        }
                        
                        if (this.cumulativeData[i].reinf && this.cumulativeData[i].button === 'left') {
                            this.ctx.stroke();
                            this.ctx.fillStyle = '#667eea';
                            this.ctx.fillRect(x - 4, y - 12, 8, 12);
                            this.ctx.beginPath();
                            this.ctx.moveTo(x, y);
                        }
                    }
                    this.ctx.stroke();
                    
                    this.ctx.strokeStyle = '#764ba2';
                    this.ctx.lineWidth = 3;
                    this.ctx.beginPath();
                    
                    for (let i = 0; i < this.cumulativeData.length; i++) {
                        const x = 50 + this.cumulativeData[i].x * scaleX;
                        const y = 350 - (this.cumulativeData[i].rightY || 0) * scaleY;
                        
                        if (i === 0) {
                            this.ctx.moveTo(x, y);
                        } else {
                            const prevY = 350 - (this.cumulativeData[i-1].rightY || 0) * scaleY;
                            this.ctx.lineTo(x, prevY);
                            this.ctx.lineTo(x, y);
                        }
                        
                        if (this.cumulativeData[i].reinf && this.cumulativeData[i].button === 'right') {
                            this.ctx.stroke();
                            this.ctx.fillStyle = '#764ba2';
                            this.ctx.fillRect(x - 4, y - 12, 8, 12);
                            this.ctx.beginPath();
                            this.ctx.moveTo(x, y);
                        }
                    }
                    this.ctx.stroke();
                    
                } else {
                    const maxR = Math.max(...this.cumulativeData.map(d => d.y));
                    const scaleY = 300 / Math.max(maxR, 10);
                    
                    this.ctx.strokeStyle = '#dc3545';
                    this.ctx.lineWidth = 3;
                    this.ctx.beginPath();
                    
                    for (let i = 0; i < this.cumulativeData.length; i++) {
                        const x = 50 + this.cumulativeData[i].x * scaleX;
                        const y = 350 - this.cumulativeData[i].y * scaleY;
                        
                        if (i === 0) {
                            this.ctx.moveTo(x, y);
                        } else {
                            const prevY = 350 - this.cumulativeData[i-1].y * scaleY;
                            this.ctx.lineTo(x, prevY);
                            this.ctx.lineTo(x, y);
                        }
                        
                        if (this.cumulativeData[i].reinf) {
                            this.ctx.stroke();
                            this.ctx.fillStyle = '#28a745';
                            this.ctx.fillRect(x-4, y-12, 8, 12);
                            this.ctx.strokeStyle = '#dc3545';
                            this.ctx.beginPath();
                            this.ctx.moveTo(x, y);
                        }
                    }
                    this.ctx.stroke();
                }
            }
        }
        
        new Simulator();
    </script>
</body>
</html>
